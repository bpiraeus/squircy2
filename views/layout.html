<!DOCTYPE html>
<html>
<head>
  <title>squIRCy</title>
  <script src="//cdn.jsdelivr.net/jquery/2.1.1/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  <script src="//cdn.jsdelivr.net/momentjs/2.8.1/moment.min.js"></script>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/bootstrap/3.2.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
	<div id="main-container" class="container">
		<div class="row">
			<div class="col-md-3 well well-sm">
				<ul class="nav nav-list">
					<li><a href="/">Dashboard</a></li>
					<li><a href="/script">Scripts</a></li>
					<li><a href="/manage">Manage</a></li>
				</ul>
			</div>
			<div class="col-md-9">
			{{ yield }}
			</div>
		</div>
	</div>

	<nav id="main-nav" class="navbar navbar-default navbar-fixed-bottom" role="navigation">
	  	<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-nav">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">squIRCy <div id="app-status" class="connected"></div></a>
        	</div>
	  	</div>
	</nav>
	
	<script type="text/javascript">
	$(function() {
		var $appStatus = $('#app-status');
		(function() {
			var fn = arguments.callee;
			$.ajax({
				url: "/status",
				dataType: "json",
				success: function(response) {
					setTimeout(fn, 30000)
					if (response.Connected) {
						if ($appStatus.hasClass('connected')) {
							return;
						}
						$appStatus.addClass('connected');
					} else {
						$appStatus.removeClass('connected');
					}
				},
				error: function() {
					$appStatus.removeClass('connected');
					setTimeout(fn, 15000)
				}
			});
		})();
	});
	</script>
</body>

</html>